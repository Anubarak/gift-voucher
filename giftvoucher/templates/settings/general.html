{% extends 'giftVoucher/_layouts/settings' %}

{% set fullPageForm = true %}

{% block saveButton %}
    {% if not craft.giftVoucher.isLicensed %}
        <div class="buttons">
            <input type="button" class="btn submit disabled" value="{{ 'Save' | t }}">
            <span class="license-error">{{ "Please enter your license key first" | t }}</span>
        </div>
    {% else %}
        {{ parent() }}
    {% endif %}
{% endblock %}

{% block blockContent %}

    {% if craft.giftVoucher.isLicensed %}
        <input type="hidden" name="action" value="plugins/savePluginSettings">
    {% endif %}
    <input type="hidden" name="pluginClass" value="giftVoucher">

    {% namespace 'settings' %}

        {% set months = [{ label: "No expiry" | t, value: 0 }] %}
        {% for i in range(1, 24) %}
            {% set months = months|merge([{ label: i, value: i }]) %}
        {% endfor %}

        {{ forms.selectField({
            label: "Voucher Expiry" | t,
            instructions: "How many months should a gift voucher be valid after the purchase date?" | t,
            name: 'expiry',
            value: settings.expiry,
            options: months,
            errors: settings.getErrors('expiry'),
            required: true,
        }) }}

        {{ forms.textField({
            label: "Voucher Code Character Length" | t,
            instructions: "Control the length of characters for the generated voucher code." | t,
            name: 'codeKeyLength',
            value: settings.codeKeyLength,
            errors: settings.getErrors('codeKeyLength'),
            required: true,
        }) }}

        {{ forms.textField({
            label: "Voucher PDF Template" | t,
            instructions: "The path to the template used for generating purchased voucher codes PDFs." | t,
            id: 'voucherCodesPdfPath',
            name: 'voucherCodesPdfPath',
            value: settings.voucherCodesPdfPath,
            errors: settings.getErrors('voucherCodesPdfPath'),
            required: true,
        }) }}

        {{ forms.textField({
            label: "Voucher PDF Filename Format" | t,
            instructions: "What the purchased codes PDF filenames should look like (sans extension). You can include tags that output order properties, such as {ex1} or {ex2}." | t({
                ex1: '<code>{number}</code>',
                ex2: '<code>{myOrderCustomField}</code>'
            }),
            id: 'voucherCodesPdfFilenameFormat',
            name: 'voucherCodesPdfFilenameFormat',
            value: settings.voucherCodesPdfFilenameFormat,
            class: 'code ltr',
            errors: settings.getErrors('voucherCodesPdfFilenameFormat'),
            required: true,
        }) }}

    {% endnamespace %}

{% endblock %}